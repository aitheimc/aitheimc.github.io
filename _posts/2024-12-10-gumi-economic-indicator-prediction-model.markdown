---
layout: post
title: 구미시 경제활동지표 예측 모델 개발
date: 2024-12-10
author: bjy
excerpt_separator: "<!--more-->"
tags:
    - timeseries
    - forecast
    - LLM
--- 
<!--more-->


- 시계열 예측 모델을 구축한 방법을 서술하고 이를 통해 도출된 예측값과 LLM 기반의 예측 결과를 비교 분석하여 각 모델의 예측 성능을 평가하고자 함
---

### 1. 개발 목표

<style>
  th {
    text-align: center;
  }
</style>

<div style="text-align: center">
<img src="../images/bjy/original_graph.png" width="1000" height="300" alt="지표">

<p style="text-align: center">- 그림 1 : 취업자 수와 경제활동인구 수 추이 -</p>
</div>
<br>


- 미래의 1개 시점을 예측하는 단기 예측 모델 학습 
- 위의 표를 구성하는 항목들을 예측하며, 예측 대상 변수들은 다음과 같음 
   - 취업자(남성/여성/전체), 전체 고용률, 경제활동인구, 경제활동참가율 <br>
- 본문에서는 취업자 수(남자/여자/전체)와 경제활동인구(남자/여자/전체) 예측 모델에 대한 내용을 중점적으로 작성

<br>

---

### 2. 보유 데이터

- 경제활동인구, 경제활동참가율, 취업자수, 고용률에 대해 전체/남성/여성으로 구분된 총 12개 항목의 데이터를 보유하고 있음<br>
- 각 항목들은 2013년 상반기부터 2024년 상반기까지 수집된 23개(시점)의 반기별 데이터<br>
- 전체 230개 지역(시/군/구) 중 데이터 수집 기간이 일치하지 않는 지역들을 제외하고 최종적으로 142개 지역의 데이터를 학습에 사용<br>

---

### 3. 변수 선정

- 예측 대상 변수들의 산출 수식은 다음과 같음

<br>
<div style="text-align: center">

<table>
 <tr>
   <th>변수</th>
   <th>수식</th>
 </tr>
 <tr>
   <td>경제활동인구(명)</td>
   <td>취업자 + 실업자</td>
 </tr>
 <tr>
   <td>경제활동참가율(%)</td>
   <td>(경제활동인구/만 15세 이상 인구) * 100</td>
 </tr>
 <tr>
   <td>취업자수(명)</td>
   <td>남성 취업자 + 여성 취업자</td>
 </tr>
 <tr>
   <td>고용률(%)</td>
   <td>(취업자수/만 15세 이상 인구) * 100</td>
 </tr>
</table>

<p style="text-align: center">- 표 1 : 경제지표 산출 수식 -</p>
</div>

<br>

- 경제활동인구-실업자 수, 경제활동참가율-만 15세 이상 인구가 활용된다는 점을 파악 
- 두 변수를 추가하여 테스트한 결과, 실업자 수와 실업률은 주요 변수로 추가하고 만 15세 이상 인구는 모델 성능을 저하시켜 제외
- 또한 보유한 데이터 수가 적고 반기 데이터임을 고려해 날짜 관련 변수는 추가하지 않고 총 14개의 변수의 순차적 패턴만을 학습하도록 함
- 여성의 경제활동 참여는 출산과 육아 등 생애주기적 요인으로 인해 불규칙한 패턴을 보이므로 예측의 정확도를 높이기 위해 비경제활동 관련 변수를 분석에 포함
- 따라서 예측에 활용한 최종 변수는 다음과 같음

<br>

<div style="text-align: center">

<table>
 <tr>
   <th>모델</th>
   <th>변수명</th>
 </tr>
 <tr>
   <td>남성 경제활동 예측 모델</td>
   <td>'경제활동인구_계','경제활동인구_남자', '경제활동인구_여자', '경제활동참가율_계','경제활동참가율_남자','경제활동참가율_여자', '고용률_계','고용률_남자', '고용률_여자', '취업자_계', '취업자_남자', '취업자_여자','실업자_계','실업률_계'</td>
 </tr>
 <tr>
   <td>여성 경제활동 예측 모델</td>
   <td>'경제활동참가율_여자','비경제활동_연령별_15-29','경제활동인구_여자','취업자_여자','비경제활동_여자','비경제활동_연령별_30-49','고용률_여자','비경제활동_활동별_육아'</td>
 </tr>
</table>

<p style="text-align: center"> - 표 2 : 활용 변수 - </p>
</div>

---

### 4. 데이터셋 구성

- 슬라이딩 윈도우 방식으로 10개의 연속된 시점을 입력값(Input)으로 사용하고, 그 다음 시점의 값을 출력값(Output)으로 하여 데이터셋을 구성

<br>

<img src="../images/bjy/input-output.png" width="700" height="300" alt="데이터셋구성">

<p style="text-align: center">- 그림 2 : 데이터셋 구성 방안 -</p>

---

### 5. 모델 구축 및 결과
#### 5.1 남성 경제활동 예측 모델

- 최종적으로 구성된 데이터셋의 shape은 다음과 같음 (데이터 수, 시퀀스 수, 특성 수)

<br>

<div style="text-align: center">

<table>
 <tr>
   <th>구분</th>
   <th>내용</th>
   <th>shape</th>
 </tr>
 <tr>
   <td>학습용 데이터</td>
   <td>구미시를 제외한 142개 지역</td>
   <td>X : (1846,10,14)<br>y : (1846,1,14)</td>
 </tr>
 <tr>
   <td>테스트 데이터</td>
   <td>구미시 데이터</td>
   <td>X: (13, 10, 14)<br>y : (13, 1, 14)</td>
 </tr>
</table>

<p style="text-align: center"> - 표 3 : 최종 데이터셋 - </p>

</div>

<img src="../images/bjy/first_prediction.png" width="800" height="400" alt="1차예측결과">

<p style="text-align: center">- 그림 3 : 1차 예측 결과 -</p>

<br>

- 남성 관련 변수들의 경우 전반적인 추세를 따라가며 예측값이 실제값과 유사한 패턴을 보이지만 여성 관련 변수들은 예측값과 실제값 간의 차이가 큼
- 따라서 여성 변수를 예측하는 모델을 별도로 학습하여 전체(남+여)를 의미하는 변수를 산출하기로 함

<br>

#### 5.2 여성 경제활동 예측 모델

<img src="../images/bjy/woman_prediction.png" width="700" height="200" alt="2차예측결과">

<p style="text-align: center">- 그림 4 :  여성 경제활동 모델 개선 결과 -</p>

<br>

- 여성 관련 변수의 경우, 각 변수들의 높은 변동성으로 인해 긴 시퀀스 사용 시 예측 정확도가 저하되는 현상이 관찰됨. 따라서 시퀀스를 6으로 설정하여 과거 데이터로 인한 노이즈를 최소화하고자 함

<br>

#### 5.3 최종 모델
<img src="../images/bjy/final_prediction.png" width="700" height="200" alt="최종예측결과">

<p style="text-align: center">- 그림 5 :  최종 예측 결과 -</p>

<br>

- 남성 관련 변수는 초기 모델을 사용하고, 여성 관련 변수는 새로운 입력 변수와 짧은 시퀀스(6)를 적용한 모델을 사용하여 최종 예측 모델을 구성
- 두 모델의 결과를 결합하여 전체 취업자/인구에 대한 예측값을 산출함

<br>

---

### 6. LLM 활용 예측

- Claude 3.5 Sonnet을 활용하여 구미시 경제활동인구에 대한 독립적인 예측을 시도
- LLM은 지역 특성, 산업 동향, 정책적 요인 등을 종합적으로 고려 가능

<br>

```
맥락:
대한민국 경상북도 구미시의 경제활동 데이터를 바탕으로 다음 시점의 주요 경제지표를 예측해야 합니다.

예측 필요 항목 (단위: 만명):
1. 경제활동인구_남자
2. 경제활동인구_여자
3. 취업자_남자
4. 취업자_여자

예측 시 준수사항:
1. 코드 작성이나 특정 알고리즘을 사용하지 말 것 - 논리적 추론을 통해 예측할 것
2. 제시된 시점까지의 데이터만 활용할 것 - 이후 시점의 정보는 배제할 것
3. 데이터셋 내 모든 변수 간의 상관관계를 고려할 것
4. 다음 요소들을 고려할 것:
   - 구미시의 산업도시로서의 특성
   - 경제적 요인들
   - 정책적 요인들

고려해야 할 주요 사항:
- 구미는 전자/IT 제조업이 발달한 주요 산업도시임
- 지역 경제 정책과 산업 동향을 고려해야 함
- 계절적 패턴과 인구통계학적 추세를 반영해야 함

출력 형식:
예측값을 다음과 같은 파이썬 리스트 형식으로 제시할 것:
경제활동인구_남자 = [예측값]
경제활동인구_여자 = [예측값]
취업자_남자 = [예측값]
취업자_여자 = [예측값]
```

<br>

- 위의 프롬프트를 활용하여 시계열 모델과 동일하게 1시점 예측을 수행

<br>

<img src="../images/bjy/llm_man_prediction.png" width="700" height="200" alt="llm남자">

<p style="text-align: center">- 그림 5 :  LLM 남자 변수 예측 결과 -</p>

<img src="../images/bjy/llm_woman_prediction.png" width="700" height="200" alt="llm여자">

<p style="text-align: center">- 그림 6 :  LLM 여자 변수 예측 결과 -</p>

<br>

- 시계열 예측 모델과 마찬가지로 LLM을 활용한 예측 결과에서도 여성 관련 변수들의 정확도가 낮게 나타남

---

### 7. 예측 결과 비교

- 앞서 학습한 시계열 모델과 LLM의 예측값을 비교한 결과는 다음과 같음

<br>

<div style="text-align: center">

<table>
  <tr>
    <th>활용 모델</th>
    <th>예측 변수</th>
    <th>MAPE</th>
  </tr>
  <tr>
    <td rowspan="4">시계열</td>
    <td>남성 취업자 수</td>
    <td>1.01%</td>
  </tr>
  <tr>
    <td>여성 취업자 수</td>
    <td>2.53%</td>
  </tr>
  <tr>
    <td>남성 경제활동인구 수</td>
    <td>1.14%</td>
  </tr>
  <tr>
    <td>여성 경제활동인구 수</td>
    <td>2.72%</td>
  </tr>
  <tr>
    <td rowspan="4">LLM</td>
    <td>남성 취업자 수</td>
    <td>1.90%</td>
  </tr>
  <tr>
    <td>여성 취업자 수</td>
    <td>2.77%</td>
  </tr>
  <tr>
    <td>남성 경제활동인구 수</td>
    <td>1.46%</td>
  </tr>
  <tr>
    <td>여성 경제활동인구 수</td>
    <td>3.00%</td>
  </tr>
</table>

<p style="text-align: center"> - 표 4 : MAPE 비교 - </p>
</div>

- 모든 변수에 대해 시계열 모델이 LLM 대비 더 낮은 MAPE를 보임
- 이는 LLM이 다양한 정성적 요인들을 포괄적으로 분석할 수 있지만 정확한 수치 예측 능력은 시계열 모델에 비해 상대적으로 제한되어 있기 때문으로 예상됨
<br>

---

- 모델을 만들기 위해서는 각 변수들에 대한 도메인 지식이 필요
- 부족한 학습데이터 수로 인해 모델의 일반화 능력에 대한 불확실성 존재 
- 추가적인 feature engineering을 통해 예측 모델의 성능을 올릴 수 있을 것으로 기대
- 프롬프트 엔지니어링을 통해 LLM의 예측 성능 향상 기대
- 시계열 모델과 LLM의 상호보완적 특성을 활용한 하이브리드 접근법을 통해 예측 정확도 개선 가능

---